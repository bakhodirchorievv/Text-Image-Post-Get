import{r as o,j as t}from"./index-Tpyj0O8T.js";import{a as q,b as h,s as z,e as H,f as J,c as K,o as Q,d as i,g as V,r as d,h as g,u as S,i as k,j as X,k as u,l as Y,m as C,n as m}from"./Firebase-BhjuJuaU.js";const Z=()=>{const[p,x]=o.useState(""),[j,w]=o.useState(""),y=async()=>{try{await q(h,p,j)}catch(r){console.error(r)}},v=async()=>{try{await z(h,H)}catch(r){console.error(r)}},f=async()=>{try{await J(h)}catch(r){console.error(r)}};return t.jsxs("div",{style:{backgroundColor:"white"},children:[t.jsx("input",{placeholder:"Email...",onChange:r=>x(r.target.value)}),t.jsx("input",{placeholder:"Password...",type:"password",onChange:r=>w(r.target.value)}),t.jsx("button",{onClick:y,children:"Sign In"}),t.jsx("button",{onClick:v,children:"Sign In With Google"}),t.jsx("button",{onClick:f,children:"Log Out"})]})},te=()=>{const[p,x]=o.useState([]),[j,w]=o.useState(""),[y,v]=o.useState(0),[f,r]=o.useState(0),[U,E]=o.useState(!1),[O,N]=o.useState(""),[I,M]=o.useState(null),[D,A]=o.useState(null),[b,T]=o.useState(null),R=K(i,"movies"),l=async()=>{try{const a=(await V(R)).docs.map(s=>({...s.data(),id:s.id}));x(a)}catch(e){console.error(e)}};o.useEffect(()=>{l();const e=Q(h,a=>{M(a?a.email:null)});return()=>e()},[]);const W=async()=>{var e,a;if(D){const s=d(g,`images/${D.name}`);await S(s,D);const n=await k(s);try{await X(R,{title:j,releaseDate:y,receivedAnOscar:U,imageUrl:n,userId:(a=(e=h)==null?void 0:e.currentUser)==null?void 0:a.uid}),l()}catch(c){console.error(c)}}else console.error("No image selected")},L=async(e,a)=>{try{const s=u(i,"movies",e);if(await Y(s),a){const n=d(g,a);try{await C(n),console.log("Image deleted successfully")}catch(c){console.error("Error deleting image: ",c)}}l(),console.log("Movie and image deleted")}catch(s){console.error("Error deleting movie or image: ",s)}},P=async e=>{try{const a=u(i,"movies",e);await m(a,{title:O}),l(),console.log("Movie updated")}catch(a){console.error("while updating title",a)}},F=async(e,a)=>{if(b){const s=d(g,`images/${b.name}`);await S(s,b);const n=await k(s),c=u(i,"movies",e);if(a){const B=d(g,a);await C(B)}await m(c,{imageUrl:n}),l(),console.log("Image updated")}else console.error("No image selected for update")},G=async(e,a)=>{const s=d(g,a);try{await C(s);const n=u(i,"movies",e);await m(n,{imageUrl:""}),l(),console.log("Image deleted")}catch(n){console.error("Error deleting image: ",n)}},$=async e=>{try{const a=u(i,"movies",e);await m(a,{releaseDate:f}),l(),console.log("Movie date updated")}catch(a){console.error("while updating release date",a)}};return t.jsxs("div",{className:"ControlData",children:[t.jsx(Z,{}),I&&t.jsxs("div",{className:"controlAuthWrapper",children:[t.jsx("input",{type:"text",placeholder:"Movie title...",onChange:e=>w(e.target.value)}),t.jsx("input",{type:"number",placeholder:"Release date...",onChange:e=>v(Number(e.target.value))}),t.jsx("input",{type:"checkbox",checked:U,id:"Oscar",onChange:e=>E(e.target.checked)}),t.jsx("label",{htmlFor:"Oscar",children:"Received an Oscar"}),t.jsx("input",{type:"file",onChange:e=>A(e.target.files?e.target.files[0]:null)}),t.jsx("button",{onClick:W,children:"Submit Movie"})]}),t.jsx("div",{className:"controlDataWrapper",children:p.map(e=>t.jsx("div",{children:I&&t.jsxs(t.Fragment,{children:[t.jsx("h1",{style:{color:e.receivedAnOscar?"green":"red"},children:e.title}),t.jsxs("p",{children:["Date: ",e.releaseDate]}),e.imageUrl&&t.jsx("img",{src:e.imageUrl,alt:e.title,width:"500"}),t.jsx("button",{onClick:()=>L(e.id,e.imageUrl),children:"Delete Movie"}),t.jsx("input",{onChange:a=>N(a.target.value),type:"text",placeholder:"new title..."}),t.jsx("button",{onClick:()=>P(e.id),children:"Update Title"}),t.jsx("br",{}),t.jsx("input",{type:"file",onChange:a=>T(a.target.files?a.target.files[0]:null)}),t.jsx("button",{onClick:()=>F(e.id,e.imageUrl),children:"Update Image"}),t.jsx("button",{onClick:()=>G(e.id,e.imageUrl),children:"Delete Image"}),t.jsx("br",{}),t.jsx("input",{type:"text",onChange:a=>r(Number(a.target.value)),placeholder:"new release date..."}),t.jsx("button",{onClick:()=>$(e.id),children:"Update Release Date"})]})},e.id))})]})};export{te as default};
